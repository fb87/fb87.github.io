'use strict';

var app = angular.module("finder", []);

app.controller("PostFinder", ["$scope", "$http", function ($scope, $http) {
    $scope.all_titles = [];
    $http.get('/api/v1.0/titles.json').then(function (response) {
        $scope.all_titles = response.data;
    });
}]);

app.controller("Discussion", ["$scope", "$http", function ($scope, $http) {
    $scope.comments = [];
    $scope.warn_message = "";

    $scope.find_comment = function (id) {
        // FIXME: github has some limitation for requesting data (60 requests/hour)
        //        better to cache the result down to local storage instead to avoid
        //        reaching that limit.
        $http.get('https://api.github.com/repos/s1ng0c/s1ng0c.github.io/issues/' + id + '/comments').then(function (response) {
            $scope.comments = response.data;
            $scope.warn_message = $scope.comments.length + " comment(s) found";
            $scope.channel = "https://github.com/s1ng0c/s1ng0c.github.io/issues/" + id;
        }, function (_) {
            $scope.warn_message = "No discussion found";
        });
    };
}]);